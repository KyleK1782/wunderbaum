/*!
 * persisto.js - utils
 * Copyright (c) 2021, Martin Wendt. Released under the MIT license.
 * v0.0.1-0, Sun, 28 Feb 2021 13:30:59 GMT (https://github.com/mar10/wunderbaum)
 */
function error(e){throw new Error(e)}function assert(e,t){if(!e)throw t=t||"Assertion failed.",new Error(t)}function extend(...e){for(let t=1;t<e.length;t++){let n=e[t];for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[0][t]=n[t])}return e[0]}function isArray(e){return Array.isArray(e)}function noop(){}
/*!
 * wunderbaum.ts
 *
 * A tree control.
 *
 * Copyright (c) 2021, Martin Wendt (https://wwWendt.de).
 * Released under the MIT license.
 *
 * @version v0.0.1-0
 * @date Sun, 28 Feb 2021 13:30:59 GMT
 */const default_debuglevel=1;var ChangeType;!function(e){e.any="any",e.children="children",e.status="status"}(ChangeType||(ChangeType={}));class WunderbaumNode{constructor(e,t,n){this.refKey=void 0,this.children=null,this.lazy=!1,this.expanded=!1,this.selected=!1,this._rowIdx=0,this._rowElem=void 0,assert(t.tree===e),this.tree=e,this.parent=t,this.title=n.title||"?",this.key=void 0===n.key?""+ ++WunderbaumNode.sequence:""+n.key}toString(){return"WunderbaumNode@"+this.key+"<'"+this.title+"'>"}visit(e,t=!1){}setExpanded(e=!0){this.expanded=e}render(){}addChild(e,t){null==this.children?this.children=[e]:t?assert(!1):this.children.push(e)}}WunderbaumNode.sequence=0;class Wunderbaum{constructor(e){this.keyMap={},this.refKeyMap={},this.rows=[],this.activeNode=null,this.root=new WunderbaumNode(this,null,{key:"__root__",name:"__root__"});let t=this.opts=extend({source:null,element:null,debugLevel:1,change:noop,error:noop},e);this.name=t.name||"wb_"+ ++Wunderbaum.sequence,t.source&&this.load(t.source)}toString(){return"Wunderbaum<'"+this.name+"'>"}debug(...e){this.opts.debugLevel>=2&&(Array.prototype.unshift.call(e,this.toString()),console.log.apply(console,e))}log(...e){this.opts.debugLevel>=1&&(Array.prototype.unshift.call(e,this.toString()),console.log.apply(console,e))}logTime(e){return this.opts.debugLevel>=1&&console.time(e),e}logTimeEnd(e){this.opts.debugLevel>=1&&console.timeEnd(e)}visit(e,t=!1){return this.root.visit(e,!1)}renumber(){let e=this.logTime("renumber");this.root.visit((function(e){}),!1),this.logTimeEnd(e)}load(e){return this._load(this.root,e)}addChildren(e,t){assert(isArray(t));for(let n=0;t.length;n++){let r=t[n];r.children,delete r.children;let o=new WunderbaumNode(this,e,r);e.addChild(o),r.children&&this.addChildren(o,r.children);break}this.setModified(e,ChangeType.children)}enableUpdate(e,t){return!0}setModified(e,t){}_load(e,t){let n=this.opts;n.debugLevel>=2&&console.time&&console.time(this+"._load");let r=this;return new Promise((function(t,o){fetch(n.source,{method:"GET"}).then((function(e){return e.ok?n.pull.call(r,e):error("GET "+n.remote+" returned "+e.status+", "+e),e.json()})).then((function(n){r.addChildren.call(r,e,n),t(e)})).catch((function(){console.error(arguments),o(e),n.error.call(r,arguments)})).finally((function(){n.debugLevel>=2&&console.time&&console.timeEnd(r+"._load")}))}))}}Wunderbaum.version="v0.0.1-0",Wunderbaum.sequence=0;export{Wunderbaum,WunderbaumNode};
//# sourceMappingURL=wunderbaum.esm.min.js.map