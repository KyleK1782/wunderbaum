/*!
 * Wunderbaum style sheet (generated from wunderbaum.scss)
 * Copyright (c) 2021, Martin Wendt. Released under the MIT license.
 * @VERSION, @DATE (https://github.com/mar10/wunderbaum)
 */

/*
  * Some nice colors
  */
$clr-black-olive: #2d342c;
$clr-black: #1c1b19;
$clr-bronze: #816540;
$clr-gray: #868581;
$clr-midnight-blue: #1e2e47;
$clr-milk: #fcfcfc;
$clr-patina-green: #29806d;
$clr-petrol: #005c75;
$clr-signal-blue: #1e5494;
$clr-slate: #47423f;
$clr-sunflower: #f7a600;
$clr-translucent-green: #94bd31;
$clr-translucent-red: #b5373b;
$clr-umbra-gray: #56534c;

$font-stack: Helvetica, sans-serif;

$border-color: #56534c;
$node-text-color: #56534c;
$error-color: #b5373b;
$hover-color: #f7f7f7;
$alternate-color: #fcfcfc;
$hover-border-color: $hover-color;
$focus-border-color: #969da3;
$grid-color: #dedede;
$active-color: #e5f3fb;
$active-cell-color: #26a0da;
$active-border-color: #70c0e7;
$active-hover-color: #cbe8f6;
$active-hover-border-color: #26a0da;
$background-color: $clr-milk;
$active-column-color: $hover-color;
$header-color: #dedede;
$active-header-column-color: adjust-color($header-color, $lightness: -10%);
// @debug $active-header-column-color;
$filter-dimm-color: #dedede;
$filter-submatch-color: #868581;

$row-outer-height: 22px;
$row-inner-height: $row-outer-height - 2; // outer height minus border size
$row-padding-y: ($row-outer-height - $row-inner-height) / 2;
$col-padding-x: 2px; // on each side within span.wb-col

$icon-outer-height: $row-inner-height;
$icon-outer-width: 20px;
$icon-height: 16px;
$icon-width: 16px;
$icon-padding-y: ($icon-outer-height - $icon-height) / 2;
$icon-padding-x: ($icon-outer-width - $icon-width) / 2;

$header-height: $row-outer-height;

$level-rainbow: rgba(255, 255, 64, 0.07), rgba(127, 255, 127, 0.07),
  rgba(255, 127, 255, 0.07), rgba(79, 236, 236, 0.07);

div.wunderbaum {
  box-sizing: border-box;
  height: 100%; // fill parent container
  margin: 0;
  padding: 0;

  font-family: $font-stack;
  font-size: 14px;

  color: $node-text-color;
  border: 1px solid $border-color;
  overflow: hidden; // avoid unwanted effects when auto-resizing

  // Focus border is generated by the browsers per default:
  // &:focus,
  // &:focus-within {
  //   border-color: $active-border-color;
  // }

  div.wb-scroll-container {
    position: relative;
    overflow: auto;
    // scroll-behavior: smooth;
    min-height: 4px;
    // height: calc(100% - #{$header-height});  // didn't work. Using JS instead
  }

  div.wb-row {
    // Header and node list
    position: absolute;
    width: 100%;
    height: $row-outer-height;
    line-height: $row-outer-height;
    border: 1px solid transparent;
    &.wb-active,
    &.wb-selected {
      background-color: $active-color;
      // border-color: $active-border-color;
      &:hover {
        background-color: $active-hover-color;
        // border-color: $active-hover-border-color;
      }
    }
    &.wb-focus:not(.wb-active) {
      border-style: dotted;
      border-color: $active-border-color;
    }
    &.wb-active {
      // background-color: $active-hover-color;
      border-style: solid;
      border-color: $active-border-color;
      &:hover {
        // background-color: $active-hover-color;
        border-color: $active-hover-border-color;
      }
    }
    &.wb-loading {
      font-style: italic;
    }
    &.wb-error,
    &.wb-status-error {
      color: $error-color;
    }
  }

  // --- HEADER ---

  div.wb-header {
    position: relative;
    height: $header-height;
    border-bottom: 1px solid $border-color;
    padding: 0;
    background-color: $header-color;
    span.wb-col {
      font-weight: bold;
      // &::after {
      //   content: "|";
      // }
    }
  }

  span.wb-col {
    position: absolute;
    display: inline-block;
    text-overflow: ellipsis;
    height: $row-inner-height;
    line-height: $row-inner-height;
    padding: 0 $col-padding-x;
    border-right: 1px solid $grid-color;
    &:last-of-type {
      border-right: none;
    }
  }

  span.wb-node {
    user-select: none;
    // &:first-of-type {
    //   margin-left: 8px; // leftmost icon gets a little margin
    // }
  }

  i.wb-checkbox,
  i.wb-expander,
  i.wb-icon,
  i.wb-indent {
    height: $icon-outer-height;
    width: $icon-outer-width;
    padding: $icon-padding-y $icon-padding-x;
    display: inline-block;
  }

  /* Fix Bootstrap Icon alignment */
  i.bi::before {
    vertical-align: baseline;
  }
  img.wb-icon {
    width: $icon-width;
    height: $icon-height;
    padding: $icon-padding-y $icon-padding-x;
    // margin-top: $icon-padding-y;
  }
  i.wb-indent {
    // border-left: 1px solid gray;
    &::before {
      content: "\00a0";
    }
  }
  i.wb-icon.wb-spin {
    height: unset; // Prevent wobble
    width: unset;
    padding: 0 3px;
    animation: wb-spin 2s linear infinite;
  }

  span.wb-title {
    min-width: 1em;
    display: inline-block; // fix vertical offset on Chrome?
    vertical-align: top;
    overflow-x: hidden;
    white-space: nowrap;
    text-overflow: ellipsis;
  }

  /* --- GRID --- */
  &.wb-grid {
    div.wb-header {
      div.wb-row {
        span.wb-col {
          &:hover {
            background-color: $active-header-column-color;
          }
        }
      }
    }
    &.wb-cell-mode div.wb-header div.wb-row span.wb-col {
      &.wb-active {
        background-color: $active-hover-color;
      }
    }
    div.wb-node-list div.wb-row {
      border-bottom-color: $grid-color;
      &:hover:not(.wb-active):not(.wb-selected) {
        background-color: $hover-color;
        border-color: $hover-border-color;
      }
      &.wb-active {
        border-bottom-color: $active-border-color;
      }
      span.wb-col {
        border-right: 1px solid $grid-color;
      }
    }
    &.wb-cell-mode {
      div.wb-row {
        background-color: $background-color;
        span.wb-col.wb-active {
          background-color: $active-column-color;
        }
        &.wb-active {
          background-color: $active-column-color;
          span.wb-col.wb-active {
            background-color: $active-cell-color;
          }
        }
      }
    }
    &.wb-alternate div.wb-node-list {
      div.wb-row:nth-of-type(even):not(.wb-active):not(.wb-selected) {
        background-color: $alternate-color;
      }
    }
  }

  /* --- FILTER --- */
  &.wb-ext-filter-dimm,
  &.wb-ext-filter-hide {
    div.wb-node-list div.wb-row {
      color: $filter-dimm-color;
      &.wb-submatch {
        color: $filter-submatch-color;
      }
      &.wb-match {
        color: $node-text-color;
      }
    }
  }

  &.wb-rainbow {
    @for $i from 1 through length($level-rainbow) {
      i.wb-indent:nth-child(#{length($level-rainbow)}n + #{$i}) {
        background: nth($level-rainbow, $i);
      }
    }
  }
} // div.wunderbaum

/* --- TOOL CLASSES --- */

.wb-helper-center {
  text-align: center;
}
.wb-helper-right {
  text-align: right;
}
.wb-helper-invalid {
  color: $error-color;
}

@keyframes wb-spin {
  0% {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(1turn);
  }
}
